<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarot of Destiny - Ultimate Pro Version</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå 3D ‡∏û‡∏•‡∏¥‡∏Å‡πÑ‡∏û‡πà */
        .perspective { perspective: 1000px; }
        .flip-inner {
            position: relative;
            width: 100%; height: 100%;
            transition: transform 0.8s cubic-bezier(0.4, 0.2, 0.2, 1);
            transform-style: preserve-3d;
        }
        .flipped { transform: rotateY(180deg); }
        .flip-front, .flip-back {
            position: absolute;
            width: 100%; height: 100%;
            backface-visibility: hidden;
            border-radius: 0.5rem;
        }
        .flip-front { background: url('https://www.transparenttextures.com/patterns/cubes.png') #1e1b4b; transform: rotateY(0deg); border: 2px solid rgba(202, 138, 4, 0.5); }
        .flip-back { transform: rotateY(180deg); }
        
        /* ‡πÑ‡∏û‡πà‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö */
        .reversed-img { transform: rotate(180deg); }
        
        .modal-bg { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(8px); }
        .fade-in { animation: fadeIn 0.5s ease-in-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gray-950 text-white min-h-screen font-sans pb-20 overflow-x-hidden selection:bg-yellow-500 selection:text-black">

    <audio id="sound-flip" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>
    <audio id="sound-select" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>

    <div id="main-board" class="p-6 md:p-10 max-w-6xl mx-auto relative z-10">
        <h1 class="text-4xl md:text-6xl font-extrabold text-center text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-500 to-yellow-700 mb-2 drop-shadow-lg">üîÆ Tarot Pro Edition</h1>
        <p class="text-center text-gray-400 mb-8 text-lg">‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏û‡πà 3 ‡∏°‡∏¥‡∏ï‡∏¥ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏û‡πà‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö (Reversed)</p>
        
        <div class="flex flex-wrap justify-center gap-3 mb-10" id="mode-selectors">
            <button onclick="setMode(1)" class="px-5 py-2 bg-gray-900 hover:bg-yellow-600 border border-yellow-600/50 rounded-lg font-bold transition">1 ‡πÉ‡∏ö (‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô)</button>
            <button onclick="setMode(3)" class="px-5 py-2 bg-gray-900 hover:bg-yellow-600 border border-yellow-600/50 rounded-lg font-bold transition">3 ‡πÉ‡∏ö (‡∏≠‡∏î‡∏µ‡∏ï/‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô/‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï)</button>
            <button onclick="setMode(5)" class="px-5 py-2 bg-gray-900 hover:bg-yellow-600 border border-yellow-600/50 rounded-lg font-bold transition">5 ‡πÉ‡∏ö (‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å‡∏õ‡∏±‡∏ç‡∏´‡∏≤)</button>
            <button onclick="setMode(10)" class="px-5 py-2 bg-gray-900 hover:bg-yellow-600 border border-yellow-600/50 rounded-lg font-bold transition">10 ‡πÉ‡∏ö (Celtic Cross)</button>
        </div>

        <div id="layout-area" class="hidden mb-16 fade-in">
            <h2 class="text-2xl font-bold text-center text-yellow-400 mb-6" id="layout-title"></h2>
            <div id="layout-slots" class="flex flex-wrap justify-center gap-4 md:gap-6"></div>
            <p class="text-center text-gray-300 mt-8 text-xl" id="instruction-text"></p>
        </div>

        <div id="deck-area" class="hidden fade-in">
            <div class="h-px bg-gradient-to-r from-transparent via-yellow-600/50 to-transparent mb-8"></div>
            <h3 class="text-xl text-center text-gray-400 mb-6">‡∏ï‡∏±‡πâ‡∏á‡∏à‡∏¥‡∏ï‡πÉ‡∏´‡πâ‡∏™‡∏á‡∏ö ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡πÉ‡∏à</h3>
            <div id="card-grid" class="grid grid-cols-5 md:grid-cols-10 gap-2 md:gap-3"></div>
        </div>
    </div>

    <div id="card-modal" class="fixed inset-0 modal-bg z-50 hidden flex items-center justify-center p-4">
        <div class="bg-gray-900 border-2 border-yellow-600/50 rounded-2xl max-w-lg w-full p-6 relative shadow-[0_0_30px_rgba(202,138,4,0.2)]">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">‚úï</button>
            <div class="text-center">
                <p id="modal-position" class="text-yellow-500 font-bold mb-2"></p>
                <div id="reversed-badge" class="hidden inline-block bg-red-600 text-white text-xs font-bold px-2 py-1 rounded mb-2 animate-pulse">‡πÑ‡∏û‡πà‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö (Reversed)</div>
                
                <img id="modal-img" src="" class="h-72 mx-auto mb-4 rounded shadow-xl border border-gray-700 transition-transform" alt="Card">
                
                <h2 id="modal-name" class="text-3xl font-bold text-yellow-400 mb-2"></h2>
                <p id="modal-keyword" class="text-sm font-semibold text-black bg-yellow-500 inline-block px-4 py-1 rounded-full mb-4"></p>
                <p id="modal-summary" class="text-gray-300 mb-6 text-lg"></p>
                
                <button onclick="showDetailView()" class="w-full bg-gradient-to-r from-yellow-600 to-yellow-500 text-black font-bold py-3 rounded-xl hover:scale-105 transition transform shadow-lg">
                    üìú ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏û‡πà‡πÉ‡∏ö‡∏ô‡∏µ‡πâ
                </button>
            </div>
        </div>
    </div>

    <div id="detail-view" class="hidden p-6 md:p-12 max-w-5xl mx-auto fade-in">
        <button onclick="backToBoard()" class="text-yellow-400 hover:underline mb-8 text-xl font-bold flex items-center">
            ‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏ï‡πä‡∏∞‡∏õ‡∏π‡πÑ‡∏û‡πà
        </button>
        <div class="bg-gray-900/80 backdrop-blur-md rounded-3xl p-8 flex flex-col md:flex-row gap-10 shadow-2xl border border-gray-700">
            <div class="md:w-1/3 flex flex-col items-center">
                <div id="detail-reversed-badge" class="hidden bg-red-600 text-white font-bold px-4 py-1 rounded-full mb-4">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÑ‡∏û‡πà‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö (Reversed)</div>
                <img id="detail-img" src="" class="w-full max-w-[280px] rounded-lg shadow-2xl border border-gray-600 mb-6">
                <div class="w-full text-center p-4 bg-black/50 rounded-xl border border-gray-800">
                    <p class="text-gray-400 text-sm">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏û‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</p>
                    <p id="detail-position" class="text-yellow-400 font-bold text-lg"></p>
                </div>
            </div>
            <div class="md:w-2/3">
                <h1 id="detail-name" class="text-4xl font-bold text-yellow-400 mb-4"></h1>
                <p id="detail-main-meaning" class="text-xl text-gray-300 mb-8 italic border-l-4 border-yellow-500 pl-4"></p>
                
                <div class="space-y-6">
                    <div class="bg-blue-900/20 p-6 rounded-2xl border border-blue-500/30">
                        <h3 class="font-bold text-blue-400 mb-2 text-xl">üíº ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô</h3>
                        <p id="detail-work" class="text-gray-300 text-lg"></p>
                    </div>
                    <div class="bg-green-900/20 p-6 rounded-2xl border border-green-500/30">
                        <h3 class="font-bold text-green-400 mb-2 text-xl">üí∞ ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h3>
                        <p id="detail-finance" class="text-gray-300 text-lg"></p>
                    </div>
                    <div class="bg-pink-900/20 p-6 rounded-2xl border border-pink-500/30">
                        <h3 class="font-bold text-pink-400 mb-2 text-xl">‚ù§Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å</h3>
                        <p id="detail-love" class="text-gray-300 text-lg"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏û‡πà (Major Arcana + ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Minor Arcana) ---
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå keyword_rev (‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏î‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö) ‡πÅ‡∏•‡∏∞ meaning_rev (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö)
        const tarotData = [
            { id: 0, name: "0. The Fool (‡πÄ‡∏î‡∏≠‡∏∞ ‡∏ü‡∏π‡∏•)", image: "https://upload.wikimedia.org/wikipedia/commons/9/90/RWS_Tarot_00_Fool.jpg", 
              keyword: "‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà, ‡∏≠‡∏¥‡∏™‡∏£‡∏∞", keyword_rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ó, ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ",
              summary: "‡∏Å‡πâ‡∏≤‡∏ß‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏ü‡πÇ‡∏ã‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà‡πÜ", 
              meaning_rev: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏´‡∏∏‡∏ô‡∏´‡∏±‡∏ô‡∏û‡∏•‡∏±‡∏ô‡πÅ‡∏•‡πà‡∏ô ‡∏Ç‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤",
              work: "‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå", finance: "‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡πá‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå", love: "‡∏£‡∏±‡∏Å‡∏™‡∏ô‡∏∏‡∏Å ‡πÑ‡∏°‡πà‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô" },
            
            { id: 1, name: "I. The Magician (‡πÄ‡∏î‡∏≠‡∏∞ ‡πÄ‡∏°‡∏à‡∏¥‡∏Å‡πÄ‡∏ä‡∏µ‡∏¢‡∏ô)", image: "https://upload.wikimedia.org/wikipedia/commons/d/de/RWS_Tarot_01_Magician.jpg", 
              keyword: "‡∏û‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå, ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥", keyword_rev: "‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏≠‡∏Å‡∏•‡∏ß‡∏á, ‡∏Ç‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à",
              summary: "‡∏°‡∏µ‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥", 
              meaning_rev: "‡∏°‡∏µ‡∏Ñ‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏°‡πà‡∏ã‡∏∑‡πà‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏≠‡∏≤‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏û‡∏π‡∏î",
              work: "‡πÄ‡∏à‡∏£‡∏à‡∏≤ ‡∏û‡∏£‡∏µ‡πÄ‡∏ã‡∏ô‡∏ï‡πå‡∏á‡∏≤‡∏ô ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏á", finance: "‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πà‡∏á ‡∏´‡∏¢‡∏¥‡∏ö‡∏à‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≠‡∏á", love: "‡∏°‡∏µ‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡πÉ‡∏à ‡∏Ñ‡∏∏‡∏°‡πÄ‡∏Å‡∏°‡πÑ‡∏î‡πâ" },
            
            // ... (‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏û‡πà Major ‡πÉ‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢) ...
            { id: 19, name: "XIX. The Sun (‡πÄ‡∏î‡∏≠‡∏∞ ‡∏ã‡∏±‡∏ô)", image: "https://upload.wikimedia.org/wikipedia/commons/1/17/RWS_Tarot_19_Sun.jpg", 
              keyword: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à, ‡∏û‡∏•‡∏±‡∏á‡∏ö‡∏ß‡∏Å", keyword_rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤, ‡∏≠‡∏µ‡πÇ‡∏Å‡πâ‡∏™‡∏π‡∏á",
              summary: "‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≤‡∏î‡∏™‡πà‡∏≠‡∏á ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏•‡πâ‡∏ô‡∏õ‡∏£‡∏µ‡πà", 
              meaning_rev: "‡∏•‡∏∂‡∏Å‡πÜ ‡∏Ç‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏≠‡∏á‡πÇ‡∏•‡∏Å‡πÉ‡∏ô‡πÅ‡∏á‡πà‡∏£‡πâ‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ä‡∏∞‡∏•‡∏≠‡∏ï‡∏±‡∏ß",
              work: "‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏±‡πâ‡∏ô", finance: "‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á ‡∏£‡πà‡∏≥‡∏£‡∏ß‡∏¢ ‡∏°‡∏µ‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†", love: "‡πÅ‡∏Æ‡∏õ‡∏õ‡∏µ‡πâ‡πÄ‡∏≠‡∏ô‡∏î‡∏¥‡πâ‡∏á ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô" },

            // --- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏û‡πà‡∏ä‡∏∏‡∏î‡πÄ‡∏•‡πá‡∏Å (Minor Arcana: Suit of Wands - ‡πÑ‡∏°‡πâ‡πÄ‡∏ó‡πâ‡∏≤) ---
            { id: 22, name: "Ace of Wands (1 ‡πÑ‡∏°‡πâ‡πÄ‡∏ó‡πâ‡∏≤)", image: "https://upload.wikimedia.org/wikipedia/commons/1/11/Wands01.jpg", 
              keyword: "‡πÅ‡∏£‡∏á‡∏ö‡∏±‡∏ô‡∏î‡∏≤‡∏•‡πÉ‡∏à‡πÉ‡∏´‡∏°‡πà, ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡∏≤‡∏ô", keyword_rev: "‡∏´‡∏°‡∏î‡πÑ‡∏ü, ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö",
              summary: "‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡πÅ‡∏£‡∏á‡∏ö‡∏±‡∏ô‡∏î‡∏≤‡∏•‡πÉ‡∏à‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏õ‡∏µ‡πà‡∏¢‡∏°", 
              meaning_rev: "‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ï‡∏±‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡∏Ç‡∏±‡∏î‡∏Ç‡∏ß‡∏≤‡∏á‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°",
              work: "‡πÑ‡∏î‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏¥‡πä‡∏á‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏î‡πâ", finance: "‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÑ‡∏î‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà", love: "‡πÄ‡∏à‡∏≠‡∏Ñ‡∏ô‡∏ñ‡∏π‡∏Å‡πÉ‡∏à‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏õ‡∏≤‡∏£‡πå‡∏Ñ‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß" },
            
            { id: 23, name: "Two of Wands (2 ‡πÑ‡∏°‡πâ‡πÄ‡∏ó‡πâ‡∏≤)", image: "https://upload.wikimedia.org/wikipedia/commons/0/0f/Wands02.jpg", 
              keyword: "‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô, ‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå", keyword_rev: "‡∏•‡∏±‡∏á‡πÄ‡∏•, ‡∏Å‡∏•‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á",
              summary: "‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏™‡∏π‡πà‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á", 
              meaning_rev: "‡∏ï‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏ã‡∏ü‡πÇ‡∏ã‡∏ô ‡πÑ‡∏°‡πà‡∏Å‡∏•‡πâ‡∏≤‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î",
              work: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î‡∏à‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß", finance: "‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ô‡∏¥‡πà‡∏á‡πÜ ‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏ú‡∏•‡∏Å‡∏≥‡πÑ‡∏£‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï", love: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏≠‡∏¢‡∏π‡πà‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß‡∏´‡∏±‡∏ß‡∏ï‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏õ‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏≠‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ" }
            
            // ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ/‡∏ä‡∏∑‡πà‡∏≠ ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏û‡πà‡∏ñ‡πâ‡∏ß‡∏¢ (Cups), ‡∏î‡∏≤‡∏ö (Swords), ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç (Pentacles) ‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ ‡∏à‡∏ô‡∏Ñ‡∏£‡∏ö 78 ‡πÉ‡∏ö
        ];

        const layouts = {
            1: { title: "‡πÑ‡∏û‡πà 1 ‡πÉ‡∏ö (‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô)", slots: ["‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ"] },
            3: { title: "‡πÑ‡∏û‡πà 3 ‡πÉ‡∏ö (‡∏≠‡∏î‡∏µ‡∏ï ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï)", slots: ["‡∏≠‡∏î‡∏µ‡∏ï", "‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", "‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï"] },
            5: { title: "‡πÑ‡∏û‡πà 5 ‡πÉ‡∏ö (‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å)", slots: ["‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå", "‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ", "‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å", "‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°", "‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ"] },
            10: { title: "‡πÑ‡∏û‡πà 10 ‡πÉ‡∏ö (‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å)", slots: ["‡∏ï‡∏±‡∏ß‡∏ï‡∏ô", "‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡πÅ‡∏ó‡∏£‡∏Å", "‡∏£‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô", "‡∏≠‡∏î‡∏µ‡∏ï", "‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", "‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï", "‡∏ó‡∏±‡∏®‡∏ô‡∏Ñ‡∏ï‡∏¥", "‡∏Ñ‡∏ô‡∏£‡∏≠‡∏ö‡∏Ç‡πâ‡∏≤‡∏á", "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á/‡∏Å‡∏•‡∏±‡∏ß", "‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ"] }
        };

        let currentMode = 3; 
        let pickedCards = [];
        let shuffledDeck = [];

        window.onload = () => setMode(3);

        function playSound(id) {
            const sound = document.getElementById(id);
            sound.currentTime = 0;
            sound.play().catch(e => console.log("‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏î‡πâ"));
        }

        function setMode(mode) {
            currentMode = mode;
            pickedCards = [];
            document.getElementById('layout-title').innerText = layouts[mode].title;
            document.getElementById('instruction-text').innerHTML = `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà <span class="text-yellow-400 font-bold">${mode}</span> ‡πÉ‡∏ö`;
            document.getElementById('layout-area').classList.remove('hidden');
            document.getElementById('deck-area').classList.remove('hidden');
            
            renderSlots(mode);
            shuffleDeck();
        }

        function renderSlots(mode) {
            const slotContainer = document.getElementById('layout-slots');
            slotContainer.innerHTML = '';
            
            layouts[mode].slots.forEach((slotName, index) => {
                const slot = document.createElement('div');
                slot.id = `slot-${index}`;
                // ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á 3D Slot
                slot.className = 'perspective w-20 md:w-28 h-32 md:h-44 cursor-pointer';
                slot.innerHTML = `
                    <div class="flip-inner" id="flip-inner-${index}">
                        <div class="flip-front flex flex-col items-center justify-center opacity-50 border-dashed">
                            <span class="text-2xl font-bold">${index + 1}</span>
                            <p class="text-[10px] md:text-xs text-center mt-1">${slotName}</p>
                        </div>
                        <div class="flip-back overflow-hidden rounded-lg shadow-xl" id="slot-img-${index}"></div>
                    </div>
                `;
                slotContainer.appendChild(slot);
            });
        }

        function shuffleDeck() {
            let indices = Array.from({length: tarotData.length}, (_, i) => i);
            for (let i = indices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [indices[i], indices[j]] = [indices[j], indices[i]];
            }
            shuffledDeck = indices.map(i => tarotData[i]);

            const deckContainer = document.getElementById('card-grid');
            deckContainer.innerHTML = '';

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Å‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á
            shuffledDeck.forEach((card, index) => {
                const cardEl = document.createElement('div');
                cardEl.className = 'bg-indigo-950 h-20 md:h-28 rounded shadow-md cursor-pointer hover:-translate-y-2 transition transform border border-yellow-700/50 bg-[url("https://www.transparenttextures.com/patterns/cubes.png")] flex items-center justify-center';
                cardEl.innerHTML = '<span class="text-xl text-yellow-600/40">‚ùÇ</span>';
                cardEl.onclick = () => pickCard(index, cardEl);
                deckContainer.appendChild(cardEl);
            });
        }

        function pickCard(index, cardEl) {
            if (pickedCards.length >= currentMode) return;

            playSound('sound-select'); // ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ï‡∏≠‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà

            const cardData = shuffledDeck[index];
            const positionIndex = pickedCards.length;
            
            // ‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏û‡πà‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö (‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ 20%)
            const isReversed = Math.random() < 0.2; 
            
            const pickedData = { 
                ...cardData, 
                positionName: layouts[currentMode].slots[positionIndex],
                isReversed: isReversed
            };
            
            pickedCards.push(pickedData);
            cardEl.style.visibility = 'hidden';

            // ‡πÄ‡∏≠‡∏≤‡πÑ‡∏û‡πà‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô Slot ‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á
            const backFace = document.getElementById(`slot-img-${positionIndex}`);
            const rotationClass = isReversed ? 'rotate-180' : '';
            backFace.innerHTML = `<img src="${cardData.image}" class="w-full h-full object-cover ${rotationClass}">`;

            // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏¥‡∏Å‡πÑ‡∏û‡πà 3 ‡∏°‡∏¥‡∏ï‡∏¥!
            setTimeout(() => {
                playSound('sound-flip');
                document.getElementById(`flip-inner-${positionIndex}`).classList.add('flipped');
            }, 300);

            // ‡πÉ‡∏™‡πà event ‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏û‡πà‡∏ó‡∏µ‡πà‡∏´‡∏á‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î Modal
            document.getElementById(`slot-${positionIndex}`).onclick = () => openModal(pickedData);

            if (pickedCards.length === currentMode) {
                document.getElementById('instruction-text').innerHTML = `<span class="text-yellow-400 font-bold animate-pulse">‚ú® ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏û‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ ‚ú®</span>`;
                setTimeout(() => document.getElementById('deck-area').classList.add('hidden'), 500);
            } else {
                document.getElementById('instruction-text').innerText = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏µ‡∏Å ${currentMode - pickedCards.length} ‡πÉ‡∏ö...`;
            }
        }

        let currentViewingCard = null;

        function openModal(cardData) {
            currentViewingCard = cardData;
            document.getElementById('modal-position').innerText = `üìç ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: ${cardData.positionName}`;
            
            const img = document.getElementById('modal-img');
            img.src = cardData.image;
            
            // ‡πÄ‡∏ä‡πá‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö
            if (cardData.isReversed) {
                document.getElementById('reversed-badge').classList.remove('hidden');
                img.classList.add('reversed-img');
                document.getElementById('modal-keyword').innerText = cardData.keyword_rev;
                document.getElementById('modal-summary').innerText = cardData.meaning_rev;
            } else {
                document.getElementById('reversed-badge').classList.add('hidden');
                img.classList.remove('reversed-img');
                document.getElementById('modal-keyword').innerText = cardData.keyword;
                document.getElementById('modal-summary').innerText = cardData.summary;
            }
            
            document.getElementById('modal-name').innerText = cardData.name;
            document.getElementById('card-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('card-modal').classList.add('hidden');
        }

        function showDetailView() {
            closeModal();
            document.getElementById('main-board').classList.add('hidden');
            
            document.getElementById('detail-position').innerText = currentViewingCard.positionName;
            document.getElementById('detail-name').innerText = currentViewingCard.name;
            
            const img = document.getElementById('detail-img');
            img.src = currentViewingCard.image;

            if (currentViewingCard.isReversed) {
                document.getElementById('detail-reversed-badge').classList.remove('hidden');
                img.classList.add('reversed-img');
                document.getElementById('detail-main-meaning').innerText = `‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö: ${currentViewingCard.meaning_rev}`;
            } else {
                document.getElementById('detail-reversed-badge').classList.add('hidden');
                img.classList.remove('reversed-img');
                document.getElementById('detail-main-meaning').innerText = `‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°: ${currentViewingCard.summary}`;
            }

            document.getElementById('detail-work').innerText = currentViewingCard.work;
            document.getElementById('detail-finance').innerText = currentViewingCard.finance;
            document.getElementById('detail-love').innerText = currentViewingCard.love;
            
            document.getElementById('detail-view').classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function backToBoard() {
            document.getElementById('detail-view').classList.add('hidden');
            document.getElementById('main-board').classList.remove('hidden');
        }
    </script>
</body>
</html>
